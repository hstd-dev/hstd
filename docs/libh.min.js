var{Array:{isArray:w},Object:{assign:C,defineProperty:L,freeze:P},globalThis:F}=globalThis,oe=F.requestAnimationFrame,D=Symbol.for("PTR_IDENTIFIER"),j={swap(e,t){let o=this[e];return this[e]=this[t],this[t]=o,this},swapOf(e,t){return this.swap(this.indexOf(e),this.indexOf(t))}},k={switch(){this.$=!this.$}},H=function(e){let t=m(void 0);return this.watch(o=>t.$=e(o)),t},N=e=>e,G=function*(e=52){let t;for(let o=0;o<e;o++)t=Math.floor(Math.random()*31),yield 127+t+(t>141)+(t>156)},S={},m=(e,t=N,o)=>{let r=_+(o?.name||""),s=Symbol(r),l=i=>u.get(i)?void 0:i(e),g=i=>{e=i,h.forEach(l)},h=[],p=new WeakMap,u=new WeakMap;return S[s]=w(e)?C(e,j):P(C({[Symbol.toPrimitive](i){return i===D},publish(){let i=Symbol(r);return S[i]=this,i},watch(i){return i(e),p.set(i,h.push(i)-1),this},ignore:{set(i){u.set(i,!0)},delete(i){u.set(i,!1)}},abort(i){delete h[p.get(i)||-1]},get setter(){return t},get $(){return e},set $(i){i=t(i),i instanceof Promise?i.then(g):e!==i&&(e=i,h.forEach(l))},into:H},typeof e=="boolean"?k:void 0))},_;for(;(_=String.fromCharCode(...G()))in globalThis;);L(globalThis,_,{value:e=>S[e],configurable:!1,enumerable:!1});var z=/["&'<>`]/g,K={},W=e=>`&#x${K[e]||=e.charCodeAt(0).toString(16)};`;var I=Symbol.for("PTR_IDENTIFIER"),R=Symbol.for("HTML_IDENTIFIER"),B=function*(){for(let e=0;e<16;e++)yield Math.floor(Math.random()*26)+97},A=({s:e,v:t},o=[],r=[])=>{o[o.length-1]+=e[0],t.forEach((s,l)=>{s[Symbol.toPrimitive]?.(R)?(A(s,o,r),o[o.length-1]+=e[l+1]):"number string".includes(typeof s)?o[o.length-1]+=String(s).replaceAll(z,W)+e[l+1]:(r.push(s),o.push(e[l+1]))})},X=document.createDocumentFragment(),b=document.createElement("div"),Z=new XPathEvaluator,q={onloadCallbackFn:[],then(e){return this.onloadCallbackFn.length||(this.onloadCallbackFn[0]=e),this},[Symbol.toPrimitive](e){return e===R},[Symbol.iterator]:function*(){let e=[""],t=[];A(this,e,t);let o=e.join(""),r,s=!1;for(;o.includes(r=String.fromCharCode(...B())););o=e.join(r);let l=Array.from(o.matchAll(new RegExp(`<(?:(!--|\\/[^a-zA-Z])|(\\/?[a-zA-Z][^>\\s]*)|(\\/?$))[\\s].*${r}`,"g")).map(({0:{length:n},index:d})=>d+n)),g=[],h=[],p={},u=-1;b.innerHTML=o.replaceAll(r,(n,d)=>(u++,l.includes(d+16)?(g.push(u),n):(h.push(u),`<!--${r}-->${r}<!---->`)));let i=Z.evaluate(`//comment()[contains(.,'${r}')]`,b,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null);for(let n=0;n<h.length;n++){let d=i.snapshotItem(n);d.textContent="";let E=d.nextSibling;t[h[n]].watch(a=>E.textContent=a)}b.querySelectorAll(`[${r}]`).forEach((n,d)=>{let E=t[g[d]];Reflect.ownKeys(E).forEach(a=>{let c=E[a],x=typeof a;if(x==="symbol"){let f=globalThis[a.description.slice(0,52)]?.(a);if(!f?.[Symbol.toPrimitive]?.(I))return;f.$(c,n)}else if(x==="string")if(c[Symbol.toPrimitive]?.(I))if(a==="value"&&n instanceof HTMLInputElement){let f=T=>n.value=T;c.watch(f),n.addEventListener("input",({target:{value:T}})=>setTimeout(()=>{c.ignore.set(f),c.$=T,c.ignore.delete(f)}),{passive:!0})}else c.watch(f=>n[a]=f);else a==="id"&&!(c in p)?p[c]=n:n[a]=c}),n.removeAttribute(r)});for(let n of b.childNodes)yield n;this.onloadCallbackFn[0]?.(p)}},re=(e,...t)=>Object.freeze(Object.assign({s:e,v:t},q));X.appendChild(b);var O="",v={},U=m((e,t)=>Object.keys(e).forEach(o=>t.addEventListener(o,e[o],{passive:!0}))),y=new WeakMap,le=new Proxy({},{get(e,t){return t===Symbol.toPrimitive||t==="$"?U.publish():(v[t]||=m((o,r)=>{O.includes(t)||(globalThis.addEventListener(t,s=>y.get(s.target)?.[t]?.forEach?.(l=>l(s)),{passive:!0}),O+=t+"\0"),y.has(r)||y.set(r,{}),(y.get(r)[t]||=[]).push(o)},void 0,{name:"on."+t})).publish()}});var Y={},J={},Q=/[A-Z]{1}/g,V={},ee=e=>V[e]||="-"+e.toLowerCase(),M=e=>J[e]||=e.replaceAll(Q,ee),$=m((e,t)=>Object.keys(e).forEach(o=>t.attributeStyleMap.set(M(o),e[o]))),te=()=>$.publish(),he=new Proxy({},{get(e,t){return t===Symbol.toPrimitive?te:t==="$"?$.publish():(Y[t]||=m((o,r)=>{r.attributeStyleMap.set(M(t),o)})).publish()}});export{m as $,he as css,re as h,le as on};
