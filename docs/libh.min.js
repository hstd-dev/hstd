var j={},k=function*(t=52){let e;for(let n=0;n<t;n++)e=Math.floor(Math.random()*31),yield 127+e+(e>141)+(e>156)},O=()=>String.fromCharCode(...k()),x=Symbol.for("PTR_IDENTIFIER"),E={or:(t,e)=>t||e,and:(t,e)=>t&&e,xor:(t,e)=>t^e,sum:(t,e)=>t+e,sub:(t,e)=>t-e,mul:(t,e)=>t*e,div:(t,e)=>t/e,mod:(t,e)=>t%e},L=Object.assign({[Symbol.toPrimitive]([t],e){return typeof e=="string"?e==="string"&&typeof t=="function"?this.publish():t.toString():e===x},watch(t,e){return e&&t[2].set(e,[t[1].push(e)-1,!0]),this},abort(t,e){if(e){let n=t[2].get(e);n[1]=!1,delete t[1][n?.[0]]}return this},into([t],e=n=>n){let n=y(e(t));return this.watch(s=>n.$=e(s)),n},until(t,e){return new Promise(n=>{let s=l=>(typeof e=="function"?e(l):l===e)?(this.abort(s),n(this)):0;this.watch(s)})},switch(){return this.$=!this.$,this},not(){return this.into(t=>!t)},bool(){return this.into(t=>!!t)},tick(){let t=!1;return this.into(()=>t=!t)},toString(t,e){let n=d(e),s=this.into(l=>l.toString(n?e.$:e));return n&&e.watch(l=>s.$=this.$.toString(l)),s},publish(t){let e=Symbol(t[3]);return j[e]=this,e},text(){let t=new Text(this.$);return this.watch(e=>t.textContent=e),[t]}},...Object.keys(E).map(t=>({[t](e,n){let s=d(n),l=E[t],p=this.into(a=>l(a,s?n.$:n));return s&&n.watch(a=>p.$=l(this.$,a)),p}}))),d=t=>t?.[x],y=(t,e=s=>s,n={})=>{let s=[],l=new WeakMap,p=Object.assign({name:"$"},n),a=function(i,r,m){return(r||i!==o[0])&&(o[0]=i,s.forEach(u=>l.get(u)?.[1]?u(i):0)),m},o=[t,s,l,T+(n.name||""),a];return new Proxy(Object.defineProperties(Object(function(...i){let[r]=o;return typeof r=="function"?r.apply(null,i):r}),{name:{value:p.name}}),{get(i,r,m){let[u]=o;return r==="$"?u:r==="refresh"?a.bind(null,u,!0,m):r===x?!0:L[r]?.bind?.(m,o)||(typeof u[r]=="function"?function(...c){let h=c.map((f,g)=>d(f)?(f.watch(_=>(h[g]=_,b.$=m.$[r](...h))),f.$):f),b=m.into(f=>f[r](...h));return b}:m.into(c=>c[r]))},set(i,r,m){if(r=="$"){let u=e(m);u instanceof Promise?u.then(a):a(u)}return!0}})},M=t=>Object.isFrozen(t)&&Array.isArray(t),H=(t,...e)=>{let n=O(),s=t.join(n),l=new RegExp(n,"g"),p=e.map((i,r)=>d(i)?(i.watch(()=>(p[r]=i.$,o.$=a())),i.$):i),a=(i=0)=>s.replaceAll(l,()=>p[i++]),o=y(a());return o},N=(...t)=>(M(t[0])&&M(t[0]?.raw)?H:y).apply(null,t),T;for(;(T=O())in globalThis;);Object.defineProperty(globalThis,T,{value:t=>j[t],configurable:!1,enumerable:!1});var R=16,A=Symbol.for("HTML_IDENTIFIER"),W=function*(t=R){for(let e=0;e<t;e++)yield Math.floor(Math.random()*26)+97},P=new WeakMap,B=document.createDocumentFragment(),D={[Symbol.toPrimitive](t){return typeof t=="string"?[...this[Symbol.iterator]().map(e=>e.outerHTML)].join(""):t===A},toString(){return this[Symbol.toPrimitive]("string")}},z={get(t,e){let n=t[e];return typeof n=="function"&&n.toString().endsWith("() { [native code] }")?n.bind(t):n}},I=(t,e)=>Reflect.ownKeys(e).forEach(t.bind(!1,e)),F=(t,...e)=>{let n=P.get(t);if(!n){let o=t.join(""),i,r=0;for(;o.includes(i=String.fromCharCode(...W())););o=t.join(i);let m=[...o.matchAll(new RegExp(`<(?:(!--|\\/[^a-zA-Z])|(\\/?[a-zA-Z][^>\\s]*)|(\\/?$))[\\s].*?${i}`,"g"))].map(({0:{length:h},index:b})=>b+h),u=[],c=document.createElement("div");B.appendChild(c),c.innerHTML=o.replaceAll(i,(h,b)=>(u[r++]=m.includes(b+R))?i:`<br ${i}>`),P.set(t,n=()=>[c.cloneNode(!0),u,i])}let[s,l,p]=n(),a={};return s.querySelectorAll(`[${p}]`).forEach((o,i)=>{let r=e[i];if(l[i]){let m=function(u,c){let h=u[c],b=typeof c;if(b=="symbol"){let f=globalThis[c.description.slice(0,52)]?.(c);if(!d(f))return;let g=f.$(h,o);if(g?.constructor!==Object)return;I(m,g)}else if(b=="string")if(d(h))if("value\0checked".includes(c)&&c in o){o[c]=h.$;let f=g=>o[c]=g;h.watch(f),o.addEventListener("input",({target:{[c]:g}})=>{h.$="number\0range".includes(o.type)?Number(g):g},{passive:!0})}else o[c]=h.$,h.watch(f=>o[c]=f);else c=="id"&&!(h in a)?a[h]=new Proxy(o,z):o[c]=h};I(m,r)}else o.replaceWith(...r[Symbol.toPrimitive]?.(A)?r:d(r)?r.text():[new Text(r)]);o.removeAttribute(p)}),Object.assign(s.childNodes,D,{then(o){return o(a),this}})};var w=(t,e,n)=>{let s={},l=y((a,o)=>n?.(Object.entries(a).map(([i,r])=>t(i,r,o)),o)),p=()=>l.publish();return new Proxy({},{get(a,o){return o===Symbol.toPrimitive?p:o==="$"?p():(s[o]||=y(t.bind(null,o),void 0,{name:e(o)})).publish()}})};var C="\0",$=new WeakMap,Z=w(function(t,e,n){C.includes(`\0${t}\0`)||(globalThis.addEventListener(t,s=>$.get(s.target)?.[t]?.forEach(l=>l(s)),{passive:!0}),C+=t+"\0"),$.has(n)||$.set(n,{}),($.get(n)[t]||=[]).push(e)},t=>"on."+t);var G={},K=/[A-Z]{1}/g,V={},q=t=>V[t]||="-"+t.toLowerCase(),S=t=>G[t]||=t.replaceAll(K,q),J=w(function(t,e,n){return S(t)+":"+(d(e)?(e.watch(s=>n.style[S(t)]=s),e.$):e)+";"},t=>"css-"+S(t),(t,e)=>e.style.cssText=t.join(""));export{N as $,J as css,F as h,Z as on,w as prop};
