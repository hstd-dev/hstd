var E={},k=function*(e=52){let t;for(let n=0;n<e;n++)t=Math.floor(Math.random()*31),yield 127+t+(t>141)+(t>156)},w=Symbol.for("PTR_IDENTIFIER"),T={or:(e,t)=>e||t,and:(e,t)=>e&&t,xor:(e,t)=>e^t,sum:(e,t)=>e+t,sub:(e,t)=>e-t,mul:(e,t)=>e*t,div:(e,t)=>e/t,mod:(e,t)=>e%t,rsh:(e,t)=>e>>t,ursh:(e,t)=>e>>>t,lsh:(e,t)=>e<<t},A=Object.assign({[Symbol.toPrimitive](e,t){return t==="string"?this.publish():t===w},watch(e,t){return t&&e[2].set(t,[e[1].push(t)-1,!0]),this},abort(e,t){if(t){let n=e[2].get(t);n[1]=!1,delete e[1][n?.[0]]}return this},into(e,t=n=>n){let n=S(t(e[0]));return this.watch(r=>n.$=t(r)),n},until(e,t){return new Promise(n=>{let r=c=>(typeof t=="function"?t(c):c===t)?(this.abort(r),n(this)):0;this.watch(r)})},switch(){return this.$=!this.$,this},not(){return this.into(e=>!e)},bool(){return this.into(e=>!!e)},toString(e,t){let n=g(t),r=this.into(c=>c.toString(n?t.$:t));return n&&t.watch(c=>r.$=this.$.toString(c)),r},publish(e){let t=Symbol(e[3]);return E[t]=this,t},text(){let e=new Text(this.$);return this.watch(t=>e.textContent=t),[e]}},...Object.keys(T).map(e=>({[e](t,n){let r=g(n),c=T[e],f=this.into(m=>c(m,r?n.$:n));return r&&n.watch(m=>f.$=c(this.$,m)),f}}))),g=e=>e?.[w],S=(e,t=r=>r,n={})=>{let r=[],c=new WeakMap,f=Object.assign({name:"$"},n),m=function(l,i,a){return(i||l!==o[0])&&(o[0]=l,r.forEach(u=>c.get(u)?.[1]?u(l):0)),a},o=[e,r,c,x+(n.name||"")];return new Proxy(Object.defineProperties(Object(function(...l){let[i]=o;return typeof i=="function"?i.apply(null,l):i}),{name:{value:f.name}}),{get(l,i,a){let[u]=o;return i==="$"?u:i==="refresh"?m.bind(null,u,!0,a):i===w?!0:A[i]?.bind?.(a,o)||(typeof u[i]=="function"?function(...s){let h=s.map((d,p)=>g(d)?(d.watch(L=>(h[p]=L,b.$=a.$[i](...h))),d.$):d),b=a.into(d=>d[i](...h));return b}:a.into(s=>s[i]))},set(l,i,a){if(i=="$"){let u=t(a);u instanceof Promise?u.then(m):m(u)}return!0}})},y=(e,...t)=>S(e,...t),x;for(;(x=String.fromCharCode(...k()))in globalThis;);Object.defineProperty(globalThis,x,{value:e=>E[e],configurable:!1,enumerable:!1});var C=16,O=Symbol.for("HTML_IDENTIFIER"),B=function*(e=C){for(let t=0;t<e;t++)yield Math.floor(Math.random()*26)+97},j=new WeakMap,H=document.createDocumentFragment(),W={[Symbol.toPrimitive](e){return typeof e=="string"?[...this[Symbol.iterator]().map(t=>t.outerHTML)].join(""):e===O},toString(){return this[Symbol.toPrimitive]("string")}},D={get(e,t){let n=e[t];return typeof n=="function"&&n.toString().endsWith("() { [native code] }")?n.bind(e):n}},M=(e,t)=>Reflect.ownKeys(t).forEach(e.bind(!1,t)),Q=(e,...t)=>{let n=j.get(e);if(!n){let o=e.join(""),l,i=0;for(;o.includes(l=String.fromCharCode(...B())););o=e.join(l);let a=[...o.matchAll(new RegExp(`<(?:(!--|\\/[^a-zA-Z])|(\\/?[a-zA-Z][^>\\s]*)|(\\/?$))[\\s].*?${l}`,"g"))].map(({0:{length:h},index:b})=>b+h),u=[],s=document.createElement("div");H.appendChild(s),s.innerHTML=o.replaceAll(l,(h,b)=>(u[i++]=a.includes(b+C))?l:`<br ${l}>`),j.set(e,n=()=>[s.cloneNode(!0),u,l])}let[r,c,f]=n(),m={};return r.querySelectorAll(`[${f}]`).forEach((o,l)=>{let i=t[l];if(c[l]){let a=function(u,s){let h=u[s],b=typeof s;if(b=="symbol"){let d=globalThis[s.description.slice(0,52)]?.(s);if(!g(d))return;let p=d.$(h,o);if(p?.constructor!==Object)return;M(a,p)}else if(b=="string")if(g(h))if("value\0checked".includes(s)&&s in o){o[s]=h.$;let d=p=>o[s]=p;h.watch(d),o.addEventListener("input",({target:{[s]:p}})=>{h.$="number\0range".includes(o.type)?Number(p):p},{passive:!0})}else o[s]=h.$,h.watch(d=>o[s]=d);else s=="id"&&!(h in m)?m[h]=new Proxy(o,D):o[s]=h};M(a,i)}else o.replaceWith(...i[Symbol.toPrimitive]?.(O)?i:g(i)?i.text():[new Text(i)]);o.removeAttribute(f)}),Object.assign(r.childNodes,W,{then(o){return o(m),this}})};var P="",Z={},v=y((e,t)=>Object.keys(e).forEach(n=>t.addEventListener(n,e[n],{passive:!0}))),$=new WeakMap,_=()=>v.publish(),Y=new Proxy({},{get(e,t){return t===Symbol.toPrimitive?_:t==="$"?_():(Z[t]||=y((n,r)=>{P.includes(t)||(globalThis.addEventListener(t,c=>$.get(c.target)?.[t]?.forEach?.(f=>f(c)),{passive:!0}),P+=t+"\0"),typeof n=="object"&&(n=n.fn),$.has(r)||$.set(r,{}),($.get(r)[t]||=[]).push(n)},void 0,{name:"on."+t})).publish()}});var z={},F={},G=/[A-Z]{1}/g,K={},N=e=>K[e]||="-"+e.toLowerCase(),R=e=>F[e]||=e.replaceAll(G,N),V=y((e,t)=>t.style.cssText=Object.keys(e).map(n=>`${R(n)}:${e[n]};`).join("")),I=()=>V.publish(),nt=new Proxy({},{get(e,t){return t===Symbol.toPrimitive?I:t==="$"?I():(z[t]||=y((n,r)=>{r.style[R(t)]=n})).publish()}});export{y as $,nt as css,Q as h,g as isPtr,Y as on};
