var M=Symbol.for("PTR_IDENTIFIER"),P={or:(e,t)=>e||t,and:(e,t)=>e&&t,xor:(e,t)=>e^t},F={into(e){let t=e(this.$),n=t instanceof Promise,o=$(n?void 0:t);return n&&t.then(i=>o.$=i),this.watch(i=>{let s=e(i);s instanceof Promise?s.then(m=>o.$=m):o.$=s}),o},...Object.fromEntries(Object.keys(P).map(e=>[e,function(t){let n=P[e],o=p(t),i=this.into(s=>n(s,o?t.$:t));return o&&t.watch(s=>i.$=n(this.$,s)),i}])),not(){return this.into(e=>!e)},refresh(){this.$=this.$},text(){let e=new Text(this.$);return this.watch(t=>e.textContent=t),[e]}},W=function(e,t,n){return n[e].apply(n,t)},w=({prototype:e},t={})=>Object.assign(t,...Reflect.ownKeys(e).map(n=>n!="constructor"&&typeof e[n]=="function"?{[n](...o){let i=e[n].length,s=o.map((h,d)=>d<i&&p(h)?(h.watch(f=>{s[d]=f,c.$=m(this.$)}),h.$):h),m=W.bind(!1,n,s),c=this.into(m);return c}}:!1)),B={boolean:w(Boolean,{switch(){this.$=!this.$},branch(e,t){return this.into(n=>n?e:t)}}),number:w(Number),string:w(String)},H=e=>e,N=function*(e=52){let t;for(let n=0;n<e;n++)t=Math.floor(Math.random()*31),yield 127+t+(t>141)+(t>156)},E={},p=e=>!!e?.[Symbol.toPrimitive]?.(M);var D=e=>{let t={};return new Proxy(e,{get(n,o){return t[o]||=$("")},set(n,o,i){p(i)?i.watch(s=>n[o]=s):n[o]=i}})},$=(e,t=H,n)=>{let o=S+(n?.name||""),i=Symbol(o),s=typeof e,m=r=>f.get(r)?void 0:r(e),c=r=>{if(typeof r!==s)throw new TypeError(`Cannot set ${typeof r} value to ${s} pointer`);e=r,h.forEach(m)},h=[],d=new WeakMap,f=new WeakMap;return E[i]=Object.assign({[Symbol.toPrimitive](r){return typeof r=="symbol"?r===M:s=="function"&&r=="string"?i:e},publish(){let r=Symbol(o);return E[r]=this,r},watch(r,l){return d.set(r,{index:h.push(r)-1,timeout:l}),this},ignore:{set(r){f.set(r,!1)},delete(r){f.set(r,!0)}},abort(r){delete h[d.get(r).index||-1]},until(r){let l;return new Promise(a=>this.watch(l=u=>{(typeof r=="function"?r(u):u===r)&&(this.abort(l),a(u))}))},get $(){return e},set $(r){(r=t(r))instanceof Promise?r.then(c):c(r)},get type(){return s},get length(){return this.into(r=>String(r).length)}},F,B[s])},z=(e,t)=>{let n=[],o=$(n.join(""));return e.forEach((i,s)=>n[s*2]=i),t.forEach((i,s)=>{let m=s*2+1;n[m]=p(i)?(i.watch(c=>{n[m]=c,o.$=n.join("")}),i.$):String(i)}),o},j=e=>Array.isArray(e)&&Object.isFrozen(e),g=(e,...t)=>j(e)&&j(e.raw)?z(e,t):"function object".includes(typeof x)?D(e):$(e,...t),S;for(;(S=String.fromCharCode(...N()))in globalThis;);Object.defineProperty(globalThis,S,{value:e=>E[e],configurable:!1,enumerable:!1});var O=16,I=Symbol.for("HTML_IDENTIFIER"),K=function*(e=O){for(let t=0;t<e;t++)yield Math.floor(Math.random()*26)+97},R=new WeakMap,Z=document.createDocumentFragment(),v={[Symbol.toPrimitive](e){return typeof e=="string"?[...this[Symbol.iterator]().map(t=>t.outerHTML)].join(""):e===I},toString(){return this[Symbol.toPrimitive]("string")}},G={get(e,t){let n=e[t];return typeof n=="function"&&n.toString().endsWith("() { [native code] }")?n.bind(e):n}},C=(e,t)=>Reflect.ownKeys(t).forEach(e.bind(!1,t)),re=(e,...t)=>{let n=R.get(e);if(!n){let c=e.join(""),h,d=0;for(;c.includes(h=String.fromCharCode(...K())););c=e.join(h);let f=[...c.matchAll(new RegExp(`<(?:(!--|\\/[^a-zA-Z])|(\\/?[a-zA-Z][^>\\s]*)|(\\/?$))[\\s].*?${h}`,"g"))].map(({0:{length:a},index:u})=>u+a),r=[],l=document.createElement("div");Z.appendChild(l),l.innerHTML=c.replaceAll(h,(a,u)=>(r[d++]=f.includes(u+O))?h:`<br ${h}>`),R.set(e,n=()=>[l.cloneNode(!0),r,h])}let[o,i,s]=n(),m={};return o.querySelectorAll(`[${s}]`).forEach((c,h)=>{let d=t[h];if(i[h]){let f=function(r,l){let a=r[l],u=typeof l;if(u=="symbol"){let y=globalThis[l.description.slice(0,52)]?.(l);if(!p(y))return;let b=y.$(a,c);if(b?.constructor!==Object)return;C(f,b)}else if(u=="string")if(p(a))if("value\0checked".includes(l)&&l in c){c[l]=a.$;let y=b=>c[l]=b;a.watch(y),c.addEventListener("input",({target:{[l]:b}})=>{a.$="number\0range".includes(c.type)?Number(b):b},{passive:!0})}else c[l]=a.$,a.watch(y=>c[l]=y);else l=="id"&&!(a in m)?m[a]=new Proxy(c,G):c[l]=a};C(f,d)}else c.replaceWith(...d[Symbol.toPrimitive]?.(I)?d:p(d)?d.text():[new Text(d)]);c.removeAttribute(s)}),Object.assign(o.childNodes,v,{then(c){return c(m),this}})};var L="",q={},U=g((e,t)=>Object.keys(e).forEach(n=>t.addEventListener(n,e[n],{passive:!0}))),T=new WeakMap,A=()=>U.publish(),se=new Proxy({},{get(e,t){return t===Symbol.toPrimitive?A:t==="$"?A():(q[t]||=g((n,o)=>{L.includes(t)||(globalThis.addEventListener(t,i=>T.get(i.target)?.[t]?.forEach?.(s=>s(i)),{passive:!0}),L+=t+"\0"),typeof n=="object"&&(n=n.fn),T.has(o)||T.set(o,{}),(T.get(o)[t]||=[]).push(n)},void 0,{name:"on."+t})).publish()}});var J={},Q={},X=/[A-Z]{1}/g,Y={},V=e=>Y[e]||="-"+e.toLowerCase(),k=e=>Q[e]||=e.replaceAll(X,V),ee=g((e,t)=>t.style.cssText=Object.keys(e).map(n=>`${k(n)}:${e[n]};`).join("")),_=()=>ee.publish(),he=new Proxy({},{get(e,t){return t===Symbol.toPrimitive?_:t==="$"?_():(J[t]||=g((n,o)=>{o.style[k(t)]=n})).publish()}});export{g as $,he as css,re as h,p as isPtr,se as on};
