var j=Symbol.for("PTR_IDENTIFIER"),k={into(e){let t=e(this.$),n=t instanceof Promise,i=$(n?void 0:t),s=this;return n&&t.then(c=>i.$=c),this.watch(c=>{let h=e(c);h instanceof Promise?h.then(o=>i.$=o):i.$=h}),Object.assign(i,{parent:s})},refresh(){this.$=this.$},text(){let e=new Text(this.$);return this.watch(t=>e.textContent=t),[e]}},F=function(e,t,n){return n[e].apply(n,t)},w=({prototype:e},t={})=>Object.assign(t,...Reflect.ownKeys(e).map(n=>n!="constructor"&&typeof e[n]=="function"?{[n](...i){let s=e[n].length,c=i.map((a,m)=>m<s&&b(a)?(a.watch(u=>{c[m]=u,o.$=h(this.$)}),a.$):a),h=F.bind(!1,n,c),o=this.into(h);return o}}:!1)),W={boolean:w(Boolean,{switch(){this.$=!this.$},branch(e,t){return this.into(n=>n?e:t)}}),number:w(Number),string:w(String)},H=e=>e,N=function*(e=52){let t;for(let n=0;n<e;n++)t=Math.floor(Math.random()*31),yield 127+t+(t>141)+(t>156)},E={},b=e=>!!e?.[Symbol.toPrimitive]?.(j);var v=e=>{let t={};return new Proxy(e,{get(n,i){return t[i]||=$("")},set(n,i,s){b(s)?s.watch(c=>n[i]=c):n[i]=s}})},$=(e,t=H,n)=>{let i=S+(n?.name||""),s=Symbol(i),c=typeof e,h=r=>u.get(r)?void 0:r(e),o=r=>{if(typeof r!==c)throw new TypeError(`Cannot set ${typeof r} value to ${c} pointer`);e=r,a.forEach(h)},a=[],m=new WeakMap,u=new WeakMap;return E[s]=Object.assign({[Symbol.toPrimitive](r){return typeof r=="symbol"?r===j:c=="function"&&r=="string"?s:e},publish(){let r=Symbol(i);return E[r]=this,r},watch(r,l){return m.set(r,{index:a.push(r)-1,timeout:l}),this},ignore:{set(r){u.set(r,!1)},delete(r){u.set(r,!0)}},abort(r){delete a[m.get(r).index||-1]},until(r){let l;return new Promise(d=>this.watch(l=f=>{(typeof r=="function"?r(f):f===r)&&(this.abort(l),d(f))}))},get $(){return e},set $(r){(r=t(r))instanceof Promise?r.then(o):o(r)},get type(){return c},get length(){return this.into(r=>String(r).length)}},k,W[c])},B=(e,t)=>{let n=[],i=$(n.join(""));return e.forEach((s,c)=>n[c*2]=s),t.forEach((s,c)=>{let h=c*2+1;n[h]=b(s)?(s.watch(o=>{n[h]=o,i.$=n.join("")}),s.$):String(s)}),i},P=e=>Array.isArray(e)&&Object.isFrozen(e),g=(e,...t)=>P(e)&&P(e.raw)?B(e,t):"function object".includes(typeof x)?v(e):$(e,...t),S;for(;(S=String.fromCharCode(...N()))in globalThis;);Object.defineProperty(globalThis,S,{value:e=>E[e],configurable:!1,enumerable:!1});var C=16,I=Symbol.for("HTML_IDENTIFIER"),D=function*(e=C){for(let t=0;t<e;t++)yield Math.floor(Math.random()*26)+97},M=new WeakMap,z=document.createDocumentFragment(),K={[Symbol.toPrimitive](e){return typeof e=="string"?[...this[Symbol.iterator]().map(t=>t.outerHTML)].join(""):e===I},toString(){return this[Symbol.toPrimitive]("string")}},Z={get(e,t){let n=e[t];return typeof n=="function"&&n.toString().endsWith("() { [native code] }")?n.bind(e):n}},R=(e,t)=>Reflect.ownKeys(t).forEach(e.bind(!1,t)),ne=(e,...t)=>{let n=M.get(e);if(!n){let o=e.join(""),a,m=0;for(;o.includes(a=String.fromCharCode(...D())););o=e.join(a);let u=[...o.matchAll(new RegExp(`<(?:(!--|\\/[^a-zA-Z])|(\\/?[a-zA-Z][^>\\s]*)|(\\/?$))[\\s].*?${a}`,"g"))].map(({0:{length:d},index:f})=>f+d),r=[],l=document.createElement("div");z.appendChild(l),l.innerHTML=o.replaceAll(a,(d,f)=>(r[m++]=u.includes(f+C))?a:`<br ${a}>`),M.set(e,n=()=>[l.cloneNode(!0),r,a])}let[i,s,c]=n(),h={};return i.querySelectorAll(`[${c}]`).forEach((o,a)=>{let m=t[a];if(s[a]){let u=function(r,l){let d=r[l],f=typeof l;if(f=="symbol"){let y=globalThis[l.description.slice(0,52)]?.(l);if(!b(y))return;let p=y.$(d,o);if(p?.constructor!==Object)return;R(u,p)}else if(f=="string")if(b(d))if("value\0checked".includes(l)&&l in o){o[l]=d.$;let y=p=>o[l]=p;d.watch(y),o.addEventListener("input",({target:{[l]:p}})=>{d.$="number\0range".includes(o.type)?Number(p):p},{passive:!0})}else o[l]=d.$,d.watch(y=>o[l]=y);else l=="id"&&!(d in h)?h[d]=new Proxy(o,Z):o[l]=d};R(u,m)}else o.replaceWith(...m[Symbol.toPrimitive]?.(I)?m:b(m)?m.text():[new Text(m)]);o.removeAttribute(c)}),Object.assign(i.childNodes,K,{then(o){return o(h),this}})};var A="",G={},q=g((e,t)=>Object.keys(e).forEach(n=>t.addEventListener(n,e[n],{passive:!0}))),T=new WeakMap,L=()=>q.publish(),ie=new Proxy({},{get(e,t){return t===Symbol.toPrimitive?L:t==="$"?L():(G[t]||=g((n,i)=>{A.includes(t)||(globalThis.addEventListener(t,s=>T.get(s.target)?.[t]?.forEach?.(c=>c(s)),{passive:!0}),A+=t+"\0"),typeof n=="object"&&(n=n.fn),T.has(i)||T.set(i,{}),(T.get(i)[t]||=[]).push(n)},void 0,{name:"on."+t})).publish()}});var U={},J={},Q=/[A-Z]{1}/g,X={},Y=e=>X[e]||="-"+e.toLowerCase(),_=e=>J[e]||=e.replaceAll(Q,Y),V=g((e,t)=>t.style.cssText=Object.keys(e).map(n=>`${_(n)}:${e[n]};`).join("")),O=()=>V.publish(),le=new Proxy({},{get(e,t){return t===Symbol.toPrimitive?O:t==="$"?O():(U[t]||=g((n,i)=>{i.style[_(t)]=n})).publish()}});export{g as $,le as css,ne as h,b as isPtr,ie as on};
