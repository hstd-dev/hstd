var M=Symbol.for("PTR_IDENTIFIER"),k={into(e){let t=T(e(this.$),void 0),n=this;return this.watch(i=>t.$=e(i)),Object.assign(t,{parent:n})},refresh(){this.$=this.$},text(){let e=new Text(this.$);return this.watch(t=>e.textContent=t),[e]}},F=function(e,t,n){return n[e].apply(n,t)},w=({prototype:e},t={})=>Object.assign(t,...Reflect.ownKeys(e).map(n=>n!="constructor"&&typeof e[n]=="function"?{[n](...i){let s=i.map((r,h)=>y(r)?(r.watch(d=>{s[h]=d,m.$=l(this.$)}),r.$):r),l=F.bind(!1,n,s),m=this.into(l);return m}}:!1)),W={boolean:w(Boolean,{switch(){this.$=!this.$},branch(e,t){return this.into(n=>n?e:t)}}),number:w(Number),string:w(String)},H=e=>e,N=function*(e=52){let t;for(let n=0;n<e;n++)t=Math.floor(Math.random()*31),yield 127+t+(t>141)+(t>156)},E={},y=e=>!!e?.[Symbol.toPrimitive]?.(M);var v=e=>{let t={};return new Proxy(e,{get(n,i){return t[i]||=T("")},set(n,i,s){y(s)?s.watch(l=>n[i]=l):n[i]=s}})},T=(e,t=H,n)=>{let i=S+(n?.name||""),s=Symbol(i),l=typeof e,m=o=>u.get(o)?void 0:o(e),r=o=>{if(typeof o!==l)throw new TypeError(`Cannot set ${typeof o} value to ${l} pointer`);e=o,h.forEach(m)},h=[],d=new WeakMap,u=new WeakMap;return E[s]=Object.assign({[Symbol.toPrimitive](o){return typeof o=="symbol"?o===M:l=="function"&&o=="string"?s:e},publish(){let o=Symbol(i);return E[o]=this,o},watch(o,c){return d.set(o,{index:h.push(o)-1,timeout:c}),this},ignore:{set(o){u.set(o,!1)},delete(o){u.set(o,!0)}},abort(o){delete h[d.get(o).index||-1]},until(o){let c;return new Promise(a=>this.watch(c=p=>{(typeof o=="function"?o(p):p===o)&&(this.abort(c),a(p))}))},get $(){return e},set $(o){(o=t(o))instanceof Promise?o.then(r):r(o)},get type(){return l},get length(){return this.into(o=>String(o).length)}},k,W[l])},B=(e,t)=>{let n=[],i=T(n.join(""));return e.forEach((s,l)=>n[l*2]=s),t.forEach((s,l)=>{let m=l*2+1;n[m]=y(s)?(s.watch(r=>{n[m]=r,i.$=n.join("")}),s.$):String(s)}),i},j=e=>Array.isArray(e)&&Object.isFrozen(e),g=(e,...t)=>j(e)&&j(e.raw)?B(e,t):"function object".includes(typeof x)?v(e):T(e,...t),S;for(;(S=String.fromCharCode(...N()))in globalThis;);Object.defineProperty(globalThis,S,{value:e=>E[e],configurable:!1,enumerable:!1});var C=16,R=Symbol.for("HTML_IDENTIFIER"),D=function*(e=C){for(let t=0;t<e;t++)yield Math.floor(Math.random()*26)+97},P=new WeakMap,z=document.createDocumentFragment(),K={[Symbol.toPrimitive](e){return typeof e=="string"?[...this[Symbol.iterator]().map(t=>t.outerHTML)].join(""):e===R},toString(){return this[Symbol.toPrimitive]("string")}},Z={get(e,t){let n=e[t];return typeof n=="function"&&n.toString().endsWith("() { [native code] }")?n.bind(e):n}},I=(e,t)=>Reflect.ownKeys(t).forEach(e.bind(!1,t)),ne=(e,...t)=>{let n=P.get(e);if(!n){let r=e.join(""),h,d=0;for(;r.includes(h=String.fromCharCode(...D())););r=e.join(h);let u=[...r.matchAll(new RegExp(`<(?:(!--|\\/[^a-zA-Z])|(\\/?[a-zA-Z][^>\\s]*)|(\\/?$))[\\s].*?${h}`,"g"))].map(({0:{length:a},index:p})=>p+a),o=[],c=document.createElement("div");z.appendChild(c),c.innerHTML=r.replaceAll(h,(a,p)=>(o[d++]=u.includes(p+C))?h:`<br ${h}>`),P.set(e,n=()=>[c.cloneNode(!0),o,h])}let[i,s,l]=n(),m={};return i.querySelectorAll(`[${l}]`).forEach((r,h)=>{let d=t[h];if(s[h]){let u=function(o,c){let a=o[c],p=typeof c;if(p=="symbol"){let f=globalThis[c.description.slice(0,52)]?.(c);if(!y(f))return;let b=f.$(a,r);if(b?.constructor!==Object)return;I(u,b)}else if(p=="string")if(y(a))if("value\0checked".includes(c)&&c in r){r[c]=a.$;let f=b=>r[c]=b;a.watch(f),r.addEventListener("input",({target:{[c]:b}})=>{a.ignore.set(f),a.$="number\0range".includes(r.type)?Number(b):b,a.ignore.delete(f)},{passive:!0})}else r[c]=a.$,a.watch(f=>r[c]=f);else c=="id"&&!(a in m)?m[a]=new Proxy(r,Z):r[c]=a};I(u,d)}else r.replaceWith(...d[Symbol.toPrimitive]?.(R)?d:y(d)?d.text():[new Text(d)]);r.removeAttribute(l)}),Object.assign(i.childNodes,K,{then(r){return r(m),this}})};var A="",G={},q=g((e,t)=>Object.keys(e).forEach(n=>t.addEventListener(n,e[n],{passive:!0}))),$=new WeakMap,L=()=>q.publish(),ie=new Proxy({},{get(e,t){return t===Symbol.toPrimitive?L:t==="$"?L():(G[t]||=g((n,i)=>{A.includes(t)||(globalThis.addEventListener(t,s=>$.get(s.target)?.[t]?.forEach?.(l=>l(s)),{passive:!0}),A+=t+"\0"),typeof n=="object"&&(n=n.fn),$.has(i)||$.set(i,{}),($.get(i)[t]||=[]).push(n)},void 0,{name:"on."+t})).publish()}});var U={},J={},Q=/[A-Z]{1}/g,X={},Y=e=>X[e]||="-"+e.toLowerCase(),_=e=>J[e]||=e.replaceAll(Q,Y),V=g((e,t)=>t.style.cssText=Object.keys(e).map(n=>`${_(n)}:${e[n]};`).join("")),O=()=>V.publish(),le=new Proxy({},{get(e,t){return t===Symbol.toPrimitive?O:t==="$"?O():(U[t]||=g((n,i)=>{i.style[_(t)]=n})).publish()}});export{g as $,le as css,ne as h,y as isPtr,ie as on};
