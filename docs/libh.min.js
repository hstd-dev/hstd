var M={},z=function*(t=52){let e;for(let n=0;n<t;n++)e=Math.floor(Math.random()*31),yield 127+e+(e>141)+(e>156)},j=()=>String.fromCharCode(...z()),w=Symbol.for("PTR_IDENTIFIER"),E={or:(t,e)=>t||e,and:(t,e)=>t&&e,xor:(t,e)=>t^e,sum:(t,e)=>t+e,sub:(t,e)=>t-e,mul:(t,e)=>t*e,div:(t,e)=>t/e,mod:(t,e)=>t%e},F=Object.assign({[Symbol.toPrimitive]([t],e){return typeof e=="string"?e==="string"&&typeof t=="function"?this.publish():t.toString():e===w},watch(t,e){return e&&t[2].set(e,[t[1].push(e)-1,!0]),this},abort(t,e){if(e){let n=t[2].get(e);n[1]=!1,delete t[1][n?.[0]]}return this},into([t],e=n=>n){let n=T(e(t));return this.watch(i=>n.$=e(i)),n},until(t,e){return new Promise(n=>{let i=l=>(typeof e=="function"?e(l):l===e)?(this.abort(i),n(this)):0;this.watch(i)})},switch(){return this.$=!this.$,this},not(){return this.into(t=>!t)},bool(){return this.into(t=>!!t)},tick(){let t=!1;return this.into(()=>t=!t)},toString(t,e){let n=f(e),i=this.into(l=>l.toString(n?e.$:e));return n&&e.watch(l=>i.$=this.$.toString(l)),i},publish(t){let e=Symbol(t[3]);return M[e]=this,e},text(){let t=new Text(this.$);return this.watch(e=>t.textContent=e),[t]}},...Object.keys(E).map(t=>({[t](e,n){let i=f(n),l=E[t],p=this.into(h=>l(h,i?n.$:n));return i&&n.watch(h=>p.$=l(this.$,h)),p}}))),f=t=>t?.[w],T=(t,e=i=>i,n={})=>{let i=[],l=new WeakMap,p=Object.assign({name:"$"},n),h=function(s,r,m){return(r||s!==o[0])&&(o[0]=s,i.forEach(u=>l.get(u)?.[1]?u(s):0)),m},o=[t,i,l,x+(n.name||""),h];return new Proxy(Object.defineProperties(Object(function(...s){let[r]=o;return typeof r=="function"?r.apply(null,s):r}),{name:{value:p.name}}),{get(s,r,m){let[u]=o;return r==="$"?u:r==="refresh"?h.bind(null,u,!0,m):r===w?!0:F[r]?.bind?.(m,o)||(typeof u[r]=="function"?function(...c){let a=c.map((d,g)=>f(d)?(d.watch(D=>(a[g]=D,b.$=m.$[r](...a))),d.$):d),b=m.into(d=>d[r](...a));return b}:m.into(c=>c[r]))},set(s,r,m){if(r=="$"){let u=e(m);u instanceof Promise?u.then(h):h(u)}return!0}})},S=t=>Object.isFrozen(t)&&Array.isArray(t),V=(t,...e)=>{let n=j(),i=t.join(n),l=new RegExp(n,"g"),p=e.map((s,r)=>f(s)?(s.watch(()=>(p[r]=s.$,o.$=h())),s.$):s),h=(s=0)=>i.replaceAll(l,()=>p[s++]),o=T(h());return o},y=(...t)=>(S(t[0])&&S(t[0]?.raw)?V:T).apply(null,t),x;for(;(x=j())in globalThis;);Object.defineProperty(globalThis,x,{value:t=>M[t],configurable:!1,enumerable:!1});var I=16,R=Symbol.for("HTML_IDENTIFIER"),Z=function*(t=I){for(let e=0;e<t;e++)yield Math.floor(Math.random()*26)+97},O=new WeakMap,G=document.createDocumentFragment(),K={[Symbol.toPrimitive](t){return typeof t=="string"?[...this[Symbol.iterator]().map(e=>e.outerHTML)].join(""):t===R},toString(){return this[Symbol.toPrimitive]("string")}},q={get(t,e){let n=t[e];return typeof n=="function"&&n.toString().endsWith("() { [native code] }")?n.bind(t):n}},C=(t,e)=>Reflect.ownKeys(e).forEach(t.bind(!1,e)),et=(t,...e)=>{let n=O.get(t);if(!n){let o=t.join(""),s,r=0;for(;o.includes(s=String.fromCharCode(...Z())););o=t.join(s);let m=[...o.matchAll(new RegExp(`<(?:(!--|\\/[^a-zA-Z])|(\\/?[a-zA-Z][^>\\s]*)|(\\/?$))[\\s].*?${s}`,"g"))].map(({0:{length:a},index:b})=>b+a),u=[],c=document.createElement("div");G.appendChild(c),c.innerHTML=o.replaceAll(s,(a,b)=>(u[r++]=m.includes(b+I))?s:`<br ${s}>`),O.set(t,n=()=>[c.cloneNode(!0),u,s])}let[i,l,p]=n(),h={};return i.querySelectorAll(`[${p}]`).forEach((o,s)=>{let r=e[s];if(l[s]){let m=function(u,c){let a=u[c],b=typeof c;if(b=="symbol"){let d=globalThis[c.description.slice(0,52)]?.(c);if(!f(d))return;let g=d.$(a,o);if(g?.constructor!==Object)return;C(m,g)}else if(b=="string")if(f(a))if("value\0checked".includes(c)&&c in o){o[c]=a.$;let d=g=>o[c]=g;a.watch(d),o.addEventListener("input",({target:{[c]:g}})=>{a.$="number\0range".includes(o.type)?Number(g):g},{passive:!0})}else o[c]=a.$,a.watch(d=>o[c]=d);else c=="id"&&!(a in h)?h[a]=new Proxy(o,q):o[c]=a};C(m,r)}else o.replaceWith(...r[Symbol.toPrimitive]?.(R)?r:f(r)?r.text():[new Text(r)]);o.removeAttribute(p)}),Object.assign(i.childNodes,K,{then(o){return o(h),this}})};var _="\0",N={},$=new WeakMap,k=(t,e,n)=>{_.includes(`\0${e}\0`)||(globalThis.addEventListener(e,i=>$.get(i.target)?.[e]?.forEach(l=>l(i)),{passive:!0}),_+=e+"\0"),$.has(t)||$.set(t,{}),($.get(t)[e]||=[]).push(n)},A=y((t,e)=>Object.keys(t).forEach(n=>k(e,n,t[n]))),P=A.publish.bind(A),ot=new Proxy({},{get(t,e){return e===Symbol.toPrimitive?P:e==="$"?P():(N[e]||=y((n,i)=>k(i,e,n),void 0,{name:"on."+e})).publish()}});var J={},Q={},U=/[A-Z]{1}/g,X={},Y=t=>X[t]||="-"+t.toLowerCase(),W=t=>Q[t]||=t.replaceAll(U,Y),B=(t,e,n)=>f(e)?(e.watch(i=>n.style[W(t)]=i),e.$):e,L=y((t,e)=>e.style.cssText=Object.keys(t).map(n=>`${W(n)}:${B(n,t[n],e)};`).join("")),H=L.publish.bind(L),ct=new Proxy({},{get(t,e){return e===Symbol.toPrimitive?H:e==="$"?H():J[e]||=y((n,i)=>B(e,n,i)).publish()}});export{y as $,ct as css,et as h,ot as on};
