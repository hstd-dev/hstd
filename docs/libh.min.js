var j={},A=function*(e=52){let t;for(let n=0;n<e;n++)t=Math.floor(Math.random()*31),yield 127+t+(t>141)+(t>156)},$=Symbol.for("PTR_IDENTIFIER"),T=Symbol("UNDEFINED"),S={or:(e,t)=>e||t,and:(e,t)=>e&&t,xor:(e,t)=>e^t},B=Object.assign({[Symbol.toPrimitive](e,t){return t===$},watch(e,t){return t&&e[2].set(t,[e[1].push(t)-1,!0]),this},abort(e,t){if(t){let n=e[2].get(t);n[1]=!1,delete e[1][n?.[0]]}return this},into(e,t=n=>n){let n=x(t(e[0]));return this.watch(r=>n.$=t(r)),n},until(e,t){return new Promise(n=>{let r=h=>(typeof t=="function"?t(h):h===t)?(this.abort(r),n(this)):!1;this.watch(r)})},switch(){return this.$=!this.$,this},not(){return this.into(e=>!e)},bool(){return this.into(e=>!!e)},toString(e,t){return this.into(n=>Number(n).toString(t))},publish(e){let t=Symbol(e[3]);return j[t]=this,t},text(){let e=new Text(this.$);return this.watch(t=>e.textContent=t),[e]}},...Object.keys(S).map(e=>({[e](t,n){let r=y(n),h=S[e],b=this.into(m=>h(m,r?n.$:n));return r&&n.watch(m=>b.$=h(this.$,m)),b}}))),y=e=>e?.[$],x=(e,t=r=>r,n={})=>{let r=[],h=new WeakMap,b=Object.assign({name:"$"},n),m=function(l,o,a){return(o||l!==i[0])&&(i[0]=l,r.forEach(u=>h.get(u)?.[1]?u(l):0)),a},i=[e,r,h,E+(n.name||"")];return new Proxy(Object.defineProperties(Object(function(...l){let[o]=i;return typeof o=="function"?o.apply(null,l):o}),{name:{value:b.name}}),{get(l,o,a){let[u]=i,s=o==="$"?u:o==="refresh"?m.bind(null,u,!0,a):o===$?!0:B[o]?.bind?.(a,i)||(typeof u[o]!="function"?a.into(c=>c[o]):T);if(s===T){let c=x();s=function(...p){a.watch(d=>c.$=d[o](...p));let f=p.map((d,L)=>y(d)?(d.watch(k=>(f[L]=k,c.$=a.$[o](...f))),d.$):d);return c.$=u[o].apply(u,f),c}}return s},set(l,o,a){if(o=="$"){let u=t(a);u instanceof Promise?u.then(m):m(u)}return!0}})},g=(e,...t)=>x(e,...t),E;for(;(E=String.fromCharCode(...A()))in globalThis;);Object.defineProperty(globalThis,E,{value:e=>j[e],configurable:!1,enumerable:!1});var O=16,_=Symbol.for("HTML_IDENTIFIER"),N=function*(e=O){for(let t=0;t<e;t++)yield Math.floor(Math.random()*26)+97},M=new WeakMap,H=document.createDocumentFragment(),W={[Symbol.toPrimitive](e){return typeof e=="string"?[...this[Symbol.iterator]().map(t=>t.outerHTML)].join(""):e===_},toString(){return this[Symbol.toPrimitive]("string")}},F={get(e,t){let n=e[t];return typeof n=="function"&&n.toString().endsWith("() { [native code] }")?n.bind(e):n}},I=(e,t)=>Reflect.ownKeys(t).forEach(e.bind(!1,t)),X=(e,...t)=>{let n=M.get(e);if(!n){let i=e.join(""),l,o=0;for(;i.includes(l=String.fromCharCode(...N())););i=e.join(l);let a=[...i.matchAll(new RegExp(`<(?:(!--|\\/[^a-zA-Z])|(\\/?[a-zA-Z][^>\\s]*)|(\\/?$))[\\s].*?${l}`,"g"))].map(({0:{length:c},index:p})=>p+c),u=[],s=document.createElement("div");H.appendChild(s),s.innerHTML=i.replaceAll(l,(c,p)=>(u[o++]=a.includes(p+O))?l:`<br ${l}>`),M.set(e,n=()=>[s.cloneNode(!0),u,l])}let[r,h,b]=n(),m={};return r.querySelectorAll(`[${b}]`).forEach((i,l)=>{let o=t[l];if(h[l]){let a=function(u,s){let c=u[s],p=typeof s;if(p=="symbol"){let f=globalThis[s.description.slice(0,52)]?.(s);if(!y(f))return;let d=f.$(c,i);if(d?.constructor!==Object)return;I(a,d)}else if(p=="string")if(y(c))if("value\0checked".includes(s)&&s in i){i[s]=c.$;let f=d=>i[s]=d;c.watch(f),i.addEventListener("input",({target:{[s]:d}})=>{c.$="number\0range".includes(i.type)?Number(d):d},{passive:!0})}else i[s]=c.$,c.watch(f=>i[s]=f);else s=="id"&&!(c in m)?m[c]=new Proxy(i,F):i[s]=c};I(a,o)}else i.replaceWith(...o[Symbol.toPrimitive]?.(_)?o:y(o)?o.text():[new Text(o)]);i.removeAttribute(b)}),Object.assign(r.childNodes,W,{then(i){return i(m),this}})};var C="",Z={},z=g((e,t)=>Object.keys(e).forEach(n=>t.addEventListener(n,e[n],{passive:!0}))),w=new WeakMap,P=()=>z.publish(),et=new Proxy({},{get(e,t){return t===Symbol.toPrimitive?P:t==="$"?P():(Z[t]||=g((n,r)=>{C.includes(t)||(globalThis.addEventListener(t,h=>w.get(h.target)?.[t]?.forEach?.(b=>b(h)),{passive:!0}),C+=t+"\0"),typeof n=="object"&&(n=n.fn),w.has(r)||w.set(r,{}),(w.get(r)[t]||=[]).push(n)},void 0,{name:"on."+t})).publish()}});var G={},K={},U=/[A-Z]{1}/g,V={},q=e=>V[e]||="-"+e.toLowerCase(),D=e=>K[e]||=e.replaceAll(U,q),v=g((e,t)=>t.style.cssText=Object.keys(e).map(n=>`${D(n)}:${e[n]};`).join("")),R=()=>v.publish(),it=new Proxy({},{get(e,t){return t===Symbol.toPrimitive?R:t==="$"?R():(G[t]||=g((n,r)=>{r.style[D(t)]=n})).publish()}});export{g as $,it as css,X as h,y as isPtr,et as on};
