var j={},H=function*(e=52){let t;for(let n=0;n<e;n++)t=Math.floor(Math.random()*31),yield 127+t+(t>141)+(t>156)},M=()=>String.fromCharCode(...H()),w=Symbol.for("PTR_IDENTIFIER"),E={or:(e,t)=>e||t,and:(e,t)=>e&&t,xor:(e,t)=>e^t,sum:(e,t)=>e+t,sub:(e,t)=>e-t,mul:(e,t)=>e*t,div:(e,t)=>e/t,mod:(e,t)=>e%t},W=Object.assign({[Symbol.toPrimitive]([e],t){return typeof t=="string"?t==="string"&&typeof e=="function"?this.publish():e.toString():t===w},watch(e,t){return t&&e[2].set(t,[e[1].push(t)-1,!0]),this},abort(e,t){if(t){let n=e[2].get(t);n[1]=!1,delete e[1][n?.[0]]}return this},into([e],t=n=>n){let n=x(t(e));return this.watch(i=>n.$=t(i)),n},until(e,t){return new Promise(n=>{let i=l=>(typeof t=="function"?t(l):l===t)?(this.abort(i),n(this)):0;this.watch(i)})},switch(){return this.$=!this.$,this},not(){return this.into(e=>!e)},bool(){return this.into(e=>!!e)},toString(e,t){let n=b(t),i=this.into(l=>l.toString(n?t.$:t));return n&&t.watch(l=>i.$=this.$.toString(l)),i},publish(e){let t=Symbol(e[3]);return j[t]=this,t},text(){let e=new Text(this.$);return this.watch(t=>e.textContent=t),[e]}},...Object.keys(E).map(e=>({[e](t,n){let i=b(n),l=E[e],f=this.into(u=>l(u,i?n.$:n));return i&&n.watch(u=>f.$=l(this.$,u)),f}}))),b=e=>e?.[w],x=(e,t=i=>i,n={})=>{let i=[],l=new WeakMap,f=Object.assign({name:"$"},n),u=function(s,r,d){return(r||s!==o[0])&&(o[0]=s,i.forEach(h=>l.get(h)?.[1]?h(s):0)),d},o=[e,i,l,T+(n.name||"")];return new Proxy(Object.defineProperties(Object(function(...s){let[r]=o;return typeof r=="function"?r.apply(null,s):r}),{name:{value:f.name}}),{get(s,r,d){let[h]=o;return r==="$"?h:r==="refresh"?u.bind(null,h,!0,d):r===w?!0:W[r]?.bind?.(d,o)||(typeof h[r]=="function"?function(...c){let a=c.map((m,p)=>b(m)?(m.watch(B=>(a[p]=B,g.$=d.$[r](...a))),m.$):m),g=d.into(m=>m[r](...a));return g}:d.into(c=>c[r]))},set(s,r,d){if(r=="$"){let h=t(d);h instanceof Promise?h.then(u):u(h)}return!0}})},S=e=>Object.isFrozen(e)&&Array.isArray(e),D=(e,...t)=>{let n=M(),i=e.join(n),l=new RegExp(n,"g"),f=t.map((s,r)=>b(s)?(s.watch(()=>(f[r]=s.$,o.$=u())),s.$):s),u=(s=0)=>i.replaceAll(l,()=>f[s++]),o=x(u());return o},y=(...e)=>(S(e[0])&&S(e[0]?.raw)?D:x).apply(null,e),T;for(;(T=M())in globalThis;);Object.defineProperty(globalThis,T,{value:e=>j[e],configurable:!1,enumerable:!1});var I=16,R=Symbol.for("HTML_IDENTIFIER"),z=function*(e=I){for(let t=0;t<e;t++)yield Math.floor(Math.random()*26)+97},O=new WeakMap,F=document.createDocumentFragment(),V={[Symbol.toPrimitive](e){return typeof e=="string"?[...this[Symbol.iterator]().map(t=>t.outerHTML)].join(""):e===R},toString(){return this[Symbol.toPrimitive]("string")}},Z={get(e,t){let n=e[t];return typeof n=="function"&&n.toString().endsWith("() { [native code] }")?n.bind(e):n}},C=(e,t)=>Reflect.ownKeys(t).forEach(e.bind(!1,t)),tt=(e,...t)=>{let n=O.get(e);if(!n){let o=e.join(""),s,r=0;for(;o.includes(s=String.fromCharCode(...z())););o=e.join(s);let d=[...o.matchAll(new RegExp(`<(?:(!--|\\/[^a-zA-Z])|(\\/?[a-zA-Z][^>\\s]*)|(\\/?$))[\\s].*?${s}`,"g"))].map(({0:{length:a},index:g})=>g+a),h=[],c=document.createElement("div");F.appendChild(c),c.innerHTML=o.replaceAll(s,(a,g)=>(h[r++]=d.includes(g+I))?s:`<br ${s}>`),O.set(e,n=()=>[c.cloneNode(!0),h,s])}let[i,l,f]=n(),u={};return i.querySelectorAll(`[${f}]`).forEach((o,s)=>{let r=t[s];if(l[s]){let d=function(h,c){let a=h[c],g=typeof c;if(g=="symbol"){let m=globalThis[c.description.slice(0,52)]?.(c);if(!b(m))return;let p=m.$(a,o);if(p?.constructor!==Object)return;C(d,p)}else if(g=="string")if(b(a))if("value\0checked".includes(c)&&c in o){o[c]=a.$;let m=p=>o[c]=p;a.watch(m),o.addEventListener("input",({target:{[c]:p}})=>{a.$=o.type=="checkbox"?p!=="false":"number\0range".includes(o.type)?Number(p):p},{passive:!0})}else o[c]=a.$,a.watch(m=>o[c]=m);else c=="id"&&!(a in u)?u[a]=new Proxy(o,Z):o[c]=a};C(d,r)}else o.replaceWith(...r[Symbol.toPrimitive]?.(R)?r:b(r)?r.text():[new Text(r)]);o.removeAttribute(f)}),Object.assign(i.childNodes,V,{then(o){return o(u),this}})};var _="",G={},K=y((e,t)=>Object.keys(e).forEach(n=>t.addEventListener(n,e[n],{passive:!0}))),$=new WeakMap,A=()=>K.publish(),ot=new Proxy({},{get(e,t){return t===Symbol.toPrimitive?A:t==="$"?A():(G[t]||=y((n,i)=>{_.includes(t)||(globalThis.addEventListener(t,l=>$.get(l.target)?.[t]?.forEach?.(f=>f(l)),{passive:!0}),_+=t+"\0"),typeof n=="object"&&(n=n.fn),$.has(i)||$.set(i,{}),($.get(i)[t]||=[]).push(n)},void 0,{name:"on."+t})).publish()}});var N={},q={},J=/[A-Z]{1}/g,Q={},U=e=>Q[e]||="-"+e.toLowerCase(),k=e=>q[e]||=e.replaceAll(J,U),L=(e,t,n)=>b(t)?(t.watch(i=>n.style[k(e)]=i),t.$):t,X=y((e,t)=>t.style.cssText=Object.keys(e).map(n=>`${k(n)}:${L(n,e[n],t)};`).join("")),P=()=>X.publish(),st=new Proxy({},{get(e,t){return t===Symbol.toPrimitive?P:t==="$"?P():N[t]||=y((n,i)=>L(t,n[t],i)).publish()}});export{y as $,st as css,tt as h,b as isPtr,ot as on};
