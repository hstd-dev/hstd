var m=t=>{let e=new WeakMap,r=new Map;return n=>{let o="function\0object".includes(typeof n)?e:r,i;return o.has(n)?o.get(n):(o.set(n,i=t(n)),i)}};var x="\0",P=m(()=>({})),d=function(t,e,r){x.includes(`\0${t}\0`)||(globalThis.addEventListener(t,n=>P(n.target)[t]?.forEach?.(o=>o(n)),{passive:!0}),x+=t+"\0"),(P(r)[t]||=[]).push(e)};var u=(t,e)=>t?.constructor===e,p=t=>Object.isFrozen(t)&&u(t,Array);var{Promise:y,Function:b}=globalThis,T=Symbol.for("PTR_IDENTIFIER"),C={},$=()=>String.fromCharCode(...A()),l=t=>t?.[T],A=function*(t=52){let e=0;for(;e++<t;){let r=Math.floor(Math.random()*31);yield 127+r+(r>141)+(r>156)}},S={or:(t,e)=>t||e,and:(t,e)=>t&&e,xor:(t,e)=>t^e,sum:(t,e)=>t+e,sub:(t,e)=>t-e,mul:(t,e)=>t*e,div:(t,e)=>t/e,mod:(t,e)=>t%e},F=Object.assign({[Symbol.toPrimitive]([t],e){return typeof e=="string"?e==="string"&&u(t,b)?this.publish():t.toString():e===T},watch(t,e){return e&&t[2].set(e,[t[1].push(e)-1,!0]),this},abort(t,e){if(e){let r=t[2].get(e);r[1]=!1,delete t[1][r?.[0]]}return this},into([t],e=r=>r){let r=o=>{let i=e(o);return u(i,y)?(i.then(s=>n.$=s),void 0):n.$=i},n=h();return r(t),this.watch(r),n},until(t,e){return new y(r=>{let n=o=>(u(e,b)?e(o):o===e)?(this.abort(n),r(this)):0;this.watch(n)})},switch(){return this.$=!this.$,this},not(){return this.into(t=>!t)},bool(){return this.into(t=>!!t)},isit(t,e){return this.into(r=>r?t:e)},tick(){let t=!1;return this.into(()=>t=!t)},toString(t,e){let r=l(e),n=this.into(o=>o.toString(r?e.$:e));return r&&e.watch(o=>n.$=this.$.toString(o)),n},publish(t){let e=Symbol(t[3]);return C[e]=this,e},text(){let t=new Text(this.$);return this.watch(e=>t.textContent=e),[t]},timeout(t,e){let r=h(this.$),n;return this.watch(o=>{clearTimeout(n),n=setTimeout(()=>r.$=o,l(e)?e.$:e)}),r}},...Object.keys(S).map(t=>({[t](e,r){let n=l(r),o=S[t],i=this.into(s=>o(s,n?r.$:r));return n&&r.watch(s=>i.$=o(this.$,s)),i}}))),O=function(t,e,r,n){let o=t[2];return(r||e!==t[0])&&(t[0]=e,t[1].forEach(i=>o.get(i)?.[1]?i(e):0)),n},j=function(t,e,...r){let n=r.map((i,s)=>l(i)?i.watch(c=>(n[s]=c,o.$=t.$[e](...n))).$:i),o=t.into(i=>i[e](...n));return o},H=function(t,e,r,n,o){let[i]=t;return n==="$"?i:n==="refresh"?e.bind(null,i,!0,o):n==="constructor"||n===T?!0:n===Symbol.hasInstance?()=>!1:F[n]?.bind?.(o,t)||(u(i[n],b)?j.bind(null,o,n):o.into(s=>s[n]))},L=function(t,e,r,n,o,i,s){if(e.writable)if(i=="$"){let c=r?r(s):s;u(c,y)?c.then(n):n(c)}else t[0][i]=l(s)?s.watch(c=>t[0][i]=c).$:s;return!0},h=(t,[e,r]=[])=>{let n=[],o=new WeakMap,i=Object.assign({name:"$",writable:!0},r),s=[t,n,o,w+i.name],c=O.bind(null,s);return new Proxy(Object.defineProperties(Object(function(...a){let[f]=s;return u(f,b)?f.apply(null,a):f}),{name:{value:i.name}}),{get:H.bind(null,s,c),set:L.bind(null,s,i,e,c)})},w;for(;(w=$())in globalThis;);Object.defineProperty(globalThis,w,{value:t=>C[t],configurable:!1,enumerable:!1});var N=m(t=>{let e=$();return[t.join(e),new RegExp(e,"g")]}),W=(t,e)=>{let[r,n]=N(t),o=e.map((c,a)=>l(c)?c.watch(()=>(o[a]=c.$,s.$=i())).$:c),i=(c=0)=>r.replaceAll(n,()=>o[c++]),s=h(i());return s},E={};var it=new Proxy({},{get(t,e){}}),st=new Proxy((t,...e)=>(p(t)&&p(t?.raw)?W:h)(t,e),{get:(t,e)=>{if(e===Symbol.hasInstance)return l;if(e==="this")return;let r=E[e];return!r&&!u(globalThis[e],Function)&&(r=E[e]=h(globalThis[e]),d("resize",({target:n})=>r.$=n[e],globalThis)),r||_[e]}}),_=h(globalThis);var M=Symbol.for("HTML_IDENTIFIER"),z=document.createDocumentFragment(),k={[Symbol.toPrimitive](t){return typeof t=="string"?[...this[Symbol.iterator]().map(e=>e.outerHTML)].join(""):t===M},toString(){return this[Symbol.toPrimitive]("string")}},B={get(t,e){let r=t[e];return u(r,Function)?r.bind(t):r}},I=(t,e)=>Reflect.ownKeys(e).forEach(D.bind(null,t,e)),D=function(t,e,r){let[n,o]=t,i=e[r],s=typeof r;if(s=="symbol"){let c=globalThis[r.description.slice(0,52)]?.(r);if(!l(c))return;let a=c.$(i,o);if(a?.constructor!==Object)return;I(t,a)}else s=="string"&&(l(i)?(o[r]=i.watch(c=>o[r]=c).$,"\0value\0checked\0".includes(`\0${r}\0`)&&r in o&&d("input",({target:{[r]:c}})=>i.$="number\0range".includes(o.type)?Number(c):c,o)):o[r]=i,r=="id"&&!(i in n)&&(n[i]=new Proxy(o,B)))},G=function([t,e],r,n,o,i){let s=r[i];e[i]?I([n,o],s):o.replaceWith(...s[Symbol.toPrimitive]?.(M)?s:l(s)?s.text():[new Text(s)]),o.removeAttribute(t)},K=function(t,e){return e(t),this},Z=function(t,e){let r=t[2](),n={};return r.querySelectorAll(`[${t[0]}]`).forEach(G.bind(null,t,e,n)),Object.assign(r.childNodes,k,{then:K.bind(null,n)})},q=m(t=>{let e=t.join(""),r=0,n="t";for(;e.includes(n+=BigInt(Math.floor(Math.random()*Number.MAX_SAFE_INTEGER)).toString(36)););e=t.join(n);let o=n.length,i=[...e.matchAll(new RegExp(`<(?:(!--|\\/[^a-zA-Z])|(\\/?[a-zA-Z][^>\\s]*)|(\\/?$))[\\s].*?${n}`,"g"))].map(({0:{length:a},index:f})=>f+a),s=[],c=document.createElement("div");return z.appendChild(c),c.innerHTML=e.replaceAll(n,(a,f)=>(s[r++]=i.includes(f+o))?n:`<br ${n}>`),Z.bind(null,[n,s,c.cloneNode.bind(c,!0)])}),ht=(t,...e)=>q(t)(e);var g=(t,e)=>{let r={},n=new Proxy({},{get(s,c){return c===Symbol.toPrimitive?i:c==="$"?i():(r[c]||=h(t.bind(null,c),void 0,{name:e?e(c):""})).publish()}}),o=h(s=>{let c={};return Reflect.ownKeys(s).forEach(a=>c[n[a]]=s[a]),c}),i=()=>o.publish();return n};var Tt=g(d,m(t=>"on."+t));var v=/[A-Z]{1}/g,Q=m(t=>"-"+t.toLowerCase()),R=m(t=>t.replaceAll(v,Q)),St=g(function(t,e,{style:r}){let n=R(t);r.setProperty(n,l(e)?e.watch(o=>r.setProperty(n,o)).$:e)},m(t=>"css-"+R(t)));export{st as $,St as css,ht as h,d as listen,Tt as on};
