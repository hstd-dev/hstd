var a=(e,t=!1)=>{let r=new(t?WeakMap:Map),o=r.get.bind(r),n=r.set.bind(r);return s=>{let i=o(s);return i||(n(s,i=e(s)),i)}};var O=a(()=>({}),!0),y=a(e=>(addEventListener(e,t=>O(t.target)[e]?.forEach?.(r=>r(t)),{passive:!0}),(t,r)=>(O(r)[e]||=[]).push(t)));var f=(e,t)=>e?.constructor===t,T=e=>Object.isFrozen(e)&&f(e,Array),_=e=>typeof e[Symbol.asyncIterator]=="function";var{Promise:M,Function:P}=globalThis,E=Symbol.for("PTR_IDENTIFIER"),F={},S=()=>String.fromCharCode(...G()),h=e=>e?.[E],G=function*(e=52){let t=0;for(;t++<e;){let r=Math.floor(Math.random()*31);yield 127+r+(r>141)+(r>156)}},j={is:Object.is,leq:(e,t)=>e==t,seq:(e,t)=>e===t,or:(e,t)=>e||t,and:(e,t)=>e&&t,xor:(e,t)=>e^t,sum:(e,t)=>e+t,sub:(e,t)=>e-t,mul:(e,t)=>e*t,div:(e,t)=>e/t,mod:(e,t)=>e%t},N=Object.assign({[Symbol.toPrimitive]([e],t){return typeof t=="string"?t==="string"&&f(e,P)?this.publish():e.toString():t===E},watch(e,t){return t&&e[2].set(t,[e[1].push(t)-1,!0]),this},abort(e,t){if(t){let r=e[2].get(t);r[1]=!1,delete e[1][r?.[0]]}return this},into([e],t=r=>r){let r=n=>{let s=t(n);return f(s,M)?(s.then(i=>o.$=i),void 0):o.$=s},o=p();return r(e),this.watch(r),o},until(e,t){return new M(r=>{let o=n=>(f(t,P)?t(n):n===t)?(this.abort(o),r(this)):0;this.watch(o)})},switch(){return this.$=!this.$,this},not(){return this.into(e=>!e)},bool(){return this.into(e=>!!e)},isit(e,t){return this.into(r=>r?e:t)},tick(){let e=!1;return this.into(()=>e=!e)},toString(e,t){let r=h(t),o=this.into(n=>n.toString(r?t.$:t));return r&&t.watch(n=>o.$=this.$.toString(n)),o},publish(e){let t=Symbol(e[3]);return F[t]=this,t},text(){let e=new Text(this.$);return this.watch(t=>e.textContent=t),[e]},timeout(e,t){let r=p(this.$),o;return this.watch(n=>{clearTimeout(o),o=setTimeout(()=>r.$=n,h(t)?t.$:t)}),r},from(e,t){let r=!0;return t(o=>r?this.$=o:o,o=>r=o),this}},...Object.keys(j).map(e=>({[e](t,r){let o=h(r),n=j[e],s=this.into(i=>n(i,o?r.$:r));return o&&r.watch(i=>s.$=n(this.$,i)),s}}))),L=new WeakMap,q=(e,t)=>(...r)=>{let o=r.map((s,i)=>h(s)?s.watch(c=>(o[i]=c,n.$=e.$[t](...o))).$:s),n=e.into(s=>s[t](...o));return n},z=e=>function(t,r,o){let n=e[2];return(r||t!==e[0])&&(e[0]=t,e[1].forEach(s=>n.get(s)?.[1]?s(t):0)),o},K=a(e=>a(t=>N[e].bind(L.get(t),t),!0)),X=hasOwnProperty.bind(N),p=(e,[t,r]=[])=>{let o=[],n=new WeakMap,s=Object.assign({name:"$",writable:!0},r),i=[e,o,n,k+s.name],c=z(i),d=new Proxy(Object.defineProperties(Object(function(...u){let[m]=i;return f(m,P)?m.apply(null,u):m}),{name:{value:s.name}}),{get(u,m,g){let[l]=i;return m==="$"?l:m==="refresh"?c.bind(null,l,!0,g):m==="constructor"?!0:m===Symbol.asyncIterator?!1:m===E?!0:m===Symbol.hasInstance?()=>!1:X(m)?K(m)(i):f(l[m],P)?q(g,m):g.into(b=>b[m])},set(u,m,g){if(s.writable)if(m=="$"){let l=t?t(g):g;f(l,M)?l.then(c):c(l)}else i[0][m]=h(g)?g.watch(l=>i[0][m]=l).$:g;return!0}});return L.set(i,d),d},k;for(;(k=S())in globalThis;);Object.defineProperty(globalThis,k,{value:e=>F[e],configurable:!1,enumerable:!1});var Q=a(e=>{let t=S();return[e.join(t),new RegExp(t,"g")]},!0),Y=(e,t)=>{let[r,o]=Q(e),n=t.map((c,d)=>h(c)?c.watch(()=>(n[d]=c.$,i.$=s())).$:c),s=(c=0)=>r.replaceAll(o,()=>n[c++]),i=p(s());return i},B={},xt=new Proxy((e,...t)=>(T(e)&&T(e?.raw)?Y:p)(e,t),{get:(e,t)=>{if(t===Symbol.hasInstance)return h;if(t==="this")return;let r=B[t];return!r&&!f(globalThis[t],Function)&&(r=B[t]=p(globalThis[t]),y("resize",({target:o})=>r.$=o[t],globalThis)),r||Z[t]}}),Z=p(globalThis);var D=e=>e.prototype;var $=(e=36)=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(e);var{replaceWith:J}=D(Element),U=Symbol.for("HTML_IDENTIFIER"),V=document.createDocumentFragment(),tt={[Symbol.toPrimitive](e){return typeof e=="string"?[...this[Symbol.iterator]().map(t=>t.outerHTML)].join(""):e===U},toString(){return this[Symbol.toPrimitive]("string")}},et={get(e,t){if(t in Element.prototype)return;let r=e[t];return f(r,Function)?r.bind(e):r},set(e,t,r){return t in Element.prototype||I(null,e,{[t]:r}),!0}},I=(e,t,r)=>Reflect.ownKeys(t).forEach(o=>{let n=t[o],s=typeof o;if(s=="symbol"){let i=globalThis[o.description.slice(0,52)]?.(o);if(!h(i))return;let c=i.$(n,e);if(c?.constructor!==Object)return;I(e,c,r)}else if(s=="string")if(o=="id"){let i=new Proxy(e,et);h(n)?n.$===void 0&&(n.$=i):n in r||(r[n]=i)}else e[o]=n}),W=()=>Object.assign(document.createElement("div"),{hidden:!0}),C=(e,t)=>{if(t instanceof Promise){let r=W();t.then(C.bind(null,r)),e.replaceWith(r)}else if(_(t)){let r=document.createComment(""),o=document.createComment(""),n=W(),s=!0,i=!0,c;(async()=>{for await(let d of t){if(s&&d==="append"){i=s=!1;continue}if(s=!1,i){let u=r.nextSibling;for(;u&&u!==o;){let m=u.nextSibling;u.remove(),u=m}}(c||=o.parentNode).insertBefore(n,o),C(n,d)}r.remove(),o.remove()})(),e.replaceWith(r,o)}else J.apply(e,f(t,Array)?t.map(r=>[...r]).flat(1):t instanceof NodeList?t:h(t)?t.text():[new Text(t)])},rt=a(e=>{let t=e.join(""),r=0,o="t";for(;t.includes(o+=$()););t=e.join(o);let n=o.length,s=[...t.matchAll(new RegExp(`(?<=\\s)${o}(?=\\s*(=|/|>|\\s))`,"g"))].map(({0:{length:u},index:m})=>m+u),i=[],c=document.createElement("div"),d=c.cloneNode.bind(c,!0);return V.appendChild(c),c.innerHTML=t.replaceAll(o,(u,m)=>(i[r++]=s.includes(m+n))?o:`<br ${o}>`),u=>{let m=d(),g={};return m.querySelectorAll(`[${o}]`).forEach((l,b)=>{let A=u[b];i[b]?I(l,A,g):C(l,A),l.removeAttribute(o)}),Object.assign(m.childNodes,tt,{on(...l){return l.forEach(b=>b(g)),this}})}},!0),Rt=(e,...t)=>rt(e)(t);var x=(e,t)=>{let r=a(i=>p(e(i),void 0,{name:t?t(i):""})),o=new Proxy({},{get(i,c){return c===Symbol.toPrimitive?s:c==="$"?s():r(c).publish()}}),n=p(i=>Reflect.ownKeys(i).reduce((c,d)=>(c[o[d]]=i[d],c),{})),s=n.publish.bind(n);return o};var Bt=x(y,a(e=>"on."+e));var H=a(e=>{let t;for(;document.querySelector(`[${t=`h${$()}`}]`););return e.setAttribute(t,""),t},!0);var R=!1,w={},ot=/[A-Z]{1}/g,nt=a(e=>"-"+e.toLowerCase()),v=a(e=>e.replaceAll(ot,nt)),Xt=x(e=>(t,r)=>{let o=r.style,n=H(r),s=v(e);h(t)?o.setProperty(s,t.watch(i=>o.setProperty(s,i)).$):(R||(R=!0,queueMicrotask(()=>{document.head.append(Object.assign(document.createElement("style"),{textContent:Object.entries(w).map(([i,c])=>`[${i}]{${c}}`).join("")})),R=!1,w={}})),w[n]=(w[n]||"")+`${s}:${t};`)},a(e=>"css-"+v(e)));var it=y("input"),st=a(e=>p((t,r)=>{if(r instanceof HTMLElement){let o=!1;it(({target:{[e]:n}})=>{o=!0,t.$="number\0range".includes(r.type)?Number(n):n,o=!1},r),r[e]=t.watch(n=>o?0:r[e]=n).$}})),Ut=new Proxy({},{get:(e,t)=>st(t)});var ct=()=>{let e,t;return Object.assign(new Promise((...r)=>[e,t]=r),{resolve:e,reject:t})};export{xt as $,a as Memo,p as Pointer,x as Prop,ct as Task,Xt as css,Rt as h,Ut as io,y as listen,Bt as on};
